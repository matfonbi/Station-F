<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Pr√©dire une satisfaction ‚Äî EduPredict</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <!-- üåê Barre de navigation -->
  <header class="navbar">
    <div class="nav-container">
      <div class="logo">üéì <span>EduPredict</span></div>
      <nav class="nav-links" id="navLinks">
        <a href="/">Accueil</a>
        <a href="/api/predict">Pr√©dire</a>
        <a href="/rate-form">Noter</a>
      </nav>
      <div class="menu-toggle" id="menuToggle">‚ò∞</div>
    </div>
  </header>

  <!-- üîÆ Formulaire principal -->
  <main>
    <form method="post" action="/api/predict" class="form" id="predictForm">
      <h2 style="text-align:center; margin-bottom:1em;">üîÆ Pr√©dire la satisfaction d‚Äôun professeur</h2>

      <label>Nom :</label>
      <input name="nom" placeholder="Dupont" required>

      <label>Pr√©nom :</label>
      <input name="prenom" placeholder="Marie">

      <label>Ville :</label>
      <input name="ville" placeholder="Paris">

      <label>Description :</label>
      <textarea name="description" rows="3" placeholder="Professeur passionn√© par la data science..."></textarea>

      <label>Dipl√¥me ‚Äî niveau :</label>
      <input name="diplome_niveau" placeholder="Master, Doctorat..." required>

      <label>Dipl√¥me ‚Äî domaine :</label>
      <input name="diplome_domaine" placeholder="Informatique, Math√©matiques..." required>

      <label>Nom du cours √† venir :</label>
      <input name="course_title" placeholder="Introduction √† la data science" required>

      <!-- üéì EXP√âRIENCES DYNAMIQUES -->
      <div class="dynamic-section">
        <h3>Exp√©riences</h3>
        <div id="experience-container">
          <div class="experience-group">
            <button type="button" class="remove-button" title="Supprimer cette exp√©rience">‚ùå</button>
            <label>Exp√©rience :</label>
            <input name="experience_1_description" placeholder="Professeur de statistiques √† HETIC">
            <label>Dur√©e :</label>
            <input name="experience_1_duration" placeholder="2 ans">
          </div>
        </div>
        <button type="button" class="add-button" id="addExperience">+ Ajouter une autre exp√©rience</button>
      </div>

      <!-- üìö COURS DYNAMIQUES -->
      <div class="dynamic-section">
        <h3>Cours pr√©c√©dents</h3>
        <div id="course-container">
          <div class="course-group">
            <button type="button" class="remove-button" title="Supprimer ce cours">‚ùå</button>
            <label>Nom du cours :</label>
            <input name="course_1_title" placeholder="Python pour d√©butants">
            <label>√âtablissement :</label>
            <input name="course_1_school" placeholder="Universit√© de Paris">
            <label>Note re√ßue :</label>
            <input name="course_1_rating" type="number" step="0.1" min="0" max="5" placeholder="4.5">
          </div>
        </div>
        <button type="button" class="add-button" id="addCourse">+ Ajouter un autre cours</button>
      </div>


      <button type="submit">Lancer la pr√©diction</button>
    </form>

    {% if prediction %}
      <div class="card-result">
        <h2>‚≠ê R√©sultat de la pr√©diction</h2>

        <div class="recap">
          <h3>üßë‚Äçüè´ Informations du professeur</h3>
          <ul>
            <li><strong>Nom :</strong> {{ infos.nom }} {{ infos.prenom }}</li>
            <li><strong>Ville :</strong> {{ infos.ville }}</li>
            <li><strong>Dipl√¥me :</strong> {{ infos.diplome_niveau }} en {{ infos.diplome_domaine }}</li>
            <li><strong>Description :</strong> {{ infos.description }}</li>
          </ul>

          <h3>üìò Cours √† venir</h3>
          <p><strong>{{ infos.course_title }}</strong></p>

          {% if infos.courses %}
            <h3>üìö Cours pr√©c√©dents</h3>
            <ul>
              {% for c in infos.courses %}
                <li>
                  <strong>{{ c.title }}</strong> ‚Äî {{ c.school }}
                  {% if c.rating %}<span class="rating"> (Note : {{ c.rating }}/5)</span>{% endif %}
                </li>
              {% endfor %}
            </ul>
          {% endif %}

          {% if infos.experiences %}
            <h3>üíº Exp√©riences</h3>
            <ul>
              {% for e in infos.experiences %}
                <li>{{ e.description }} ‚Äî <em>{{ e.duration }}</em></li>
              {% endfor %}
            </ul>
          {% endif %}

          {% if infos.mean_past_rating %}
            <p><strong>Moyenne des cours pr√©c√©dents :</strong> {{ infos.mean_past_rating }}/5</p>
          {% endif %}

          <div class="prediction-score">
            <h2>Note pr√©dite : <span>{{ prediction }}/5</span></h2>
            <p class="model-used">Mod√®le utilis√© : <strong>{{ model_used }}</strong></p>
          </div>
        </div>
      </div>
    {% endif %}


    <p class="back-link"><a href="/">‚Üê Retour √† l‚Äôaccueil</a></p>
  </main>

  <footer>
    <p>¬© 2025 EduPredict ‚Äî Une innovation EdTech d√©velopp√©e √† Station F.</p>
  </footer>

  <!-- üìú Scripts -->
  <script src="/static/script.js"></script>
  <script>
    // ----- Menu mobile -----
    const menuToggle = document.getElementById("menuToggle");
    const navLinks = document.getElementById("navLinks");
    menuToggle.addEventListener("click", () => {
      navLinks.classList.toggle("active");
      menuToggle.classList.toggle("open");
    });

    // ----- Ajout et suppression d'exp√©riences -----
    let expCount = 1;
    document.getElementById("addExperience").addEventListener("click", () => {
      expCount++;
      const container = document.getElementById("experience-container");
      const div = document.createElement("div");
      div.classList.add("experience-group");
      div.innerHTML = `
        <button type="button" class="remove-button" title="Supprimer cette exp√©rience">‚ùå</button>
        <label>Exp√©rience :</label>
        <input name="experience_${expCount}_description" placeholder="Nouvelle exp√©rience">
        <label>Dur√©e :</label>
        <input name="experience_${expCount}_duration" placeholder="Dur√©e">
      `;
      container.appendChild(div);
      addRemoveEvent(div.querySelector(".remove-button"));
    });

    // ----- Ajout et suppression de cours -----
    let courseCount = 1;
    document.getElementById("addCourse").addEventListener("click", () => {
      courseCount++;
      const container = document.getElementById("course-container");
      const div = document.createElement("div");
      div.classList.add("course-group");
      div.innerHTML = `
        <button type="button" class="remove-button" title="Supprimer ce cours">‚ùå</button>
        <label>Nom du cours :</label>
        <input name="course_${courseCount}_title" placeholder="Nom du cours">
        <label>√âtablissement :</label>
        <input name="course_${courseCount}_school" placeholder="√âtablissement">
        <label>Note re√ßue :</label>
        <input name="course_${courseCount}_rating" type="number" step="0.1" min="0" max="5" placeholder="4.5">
      `;
      container.appendChild(div);
      addRemoveEvent(div.querySelector(".remove-button"));
    });


    // Fonction g√©n√©rique pour supprimer un bloc
    function addRemoveEvent(button) {
      button.addEventListener("click", (e) => {
        e.target.closest(".experience-group, .course-group").remove();
      });
    }

    // Activer la suppression sur les blocs initiaux
    document.querySelectorAll(".remove-button").forEach(addRemoveEvent);
  </script>
</body>
</html>
